Sort of DP, precalculate it and recalculate if necessary 
